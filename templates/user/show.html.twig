{% extends 'basefront.html.twig' %}

{% block title %}User Profile - Phantom Force{% endblock %}

{% block body %}
<div class="hero">
    <h1>User Profile</h1>
    <p>View and manage your profile information</p>
</div>

<div class="container" style="max-width: 800px; margin: 0 auto;">
    <div class="module-card" style="margin-top: 40px;">
        <div class="module-icon" style="background: var(--red-gradient);">
            <i class="fas fa-user"></i>
        </div>
        <h2 class="module-title">Profile Details</h2>
        
        <div class="profile-details" style="margin-top: 20px;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">ID</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.id }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Email</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.email }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Username</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.username }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Full Name</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.fullName }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Country</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.country }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Birth Date</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.birthDate ? user.birthDate|date('Y-m-d') : 'Not specified' }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Role</div>
                    <div style="font-size: 16px; font-weight: 600; color: var(--red);">{{ user.role }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Achievement Points</div>
                    <div style="font-size: 16px; font-weight: 600; color: var(--green);">{{ user.achievementPoints }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Account Status</div>
                    <div style="font-size: 16px; font-weight: 600; color: {{ user.isActive ? 'var(--green)' : 'var(--red)' }};">
                        {{ user.isActive ? 'Active' : 'Inactive' }}
                    </div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Member Since</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.createdAt ? user.createdAt|date('F j, Y') : 'Unknown' }}</div>
                </div>
                <div class="profile-field">
                    <div style="color: var(--text-muted); font-size: 14px; margin-bottom: 5px;">Last Login</div>
                    <div style="font-size: 16px; font-weight: 600;">{{ user.lastLoginAt ? user.lastLoginAt|date('F j, Y H:i') : 'Never' }}</div>
                </div>
            </div>
        </div>

        <div class="module-stats" style="margin-top: 30px; border-top: 1px solid var(--border-light); padding-top: 20px;">
            <div class="module-stat">
                <div class="module-stat-value">{{ user.achievementPoints }}</div>
                <div class="module-stat-label">Points</div>
            </div>
            <div class="module-stat">
                <div class="module-stat-value" style="color: {{ user.isActive ? 'var(--green)' : 'var(--red)' }};">
                    {{ user.isActive ? 'Active' : 'Inactive' }}
                </div>
                <div class="module-stat-label">Status</div>
            </div>
            <div class="module-stat">
                <div class="module-stat-value">{{ user.role }}</div>
                <div class="module-stat-label">Role</div>
            </div>
        </div>
    </div>

    <div style="display: flex; gap: 15px; margin-top: 30px; justify-content: center;">
       
        
        {# Show edit link only if user is admin OR viewing own profile #}
        {% if is_granted('ROLE_ADMIN') or app.user.id == user.id %}
            <a href="{{ path('app_user_edit', {'id': user.id}) }}" class="btn btn-primary">
                <i class="fas fa-edit"></i> Edit Profile
            </a>
        {% endif %}
        
        {# Only show delete button for admins #}
        {% if is_granted('ROLE_ADMIN') %}
            <form method="post" action="{{ path('app_user_delete', {'id': user.id}) }}" onsubmit="return confirm('Are you sure you want to delete this user?');" style="display: inline;">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
                <button type="submit" class="btn" style="background: var(--red-gradient); color: white;">
                    <i class="fas fa-trash"></i> Delete User
                </button>
            </form>
        {% endif %}
    </div>
</div>
{% endblock %}